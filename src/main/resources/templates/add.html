<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset="UTF-8" />
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="viewport" content="width=device-width" />
	<title>Cadastro</title>
	<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet"></link>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
	<script src="https://code.jquery.com/jquery-3.4.1.min.js"
            integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
            crossorigin="anonymous"></script>
            <script type="text/javascript" >

        $(document).ready(function() {

            function limpa_formulário_cep() {
                // Limpa valores do formulário de cep.
                $("#endereco").val("");
                $("#bairro").val("");
                $("#cidade").val("");
                $("#estado").val("");
            }
            
            //Quando o campo cep perde o foco.
            $("#cep").blur(function() {

                //Nova variável "cep" somente com dígitos.
                var cep = $(this).val().replace(/\D/g, '');

                //Verifica se campo cep possui valor informado.
                if (cep != "") {

                    //Expressão regular para validar o CEP.
                    var validacep = /^[0-9]{8}$/;

                    //Valida o formato do CEP.
                    if(validacep.test(cep)) {

                        //Preenche os campos com "..." enquanto consulta webservice.
                        $("#endereco").val("...");
                        $("#bairro").val("...");
                        $("#cidade").val("...");
                        $("#estado").val("...");

                        //Consulta o webservice viacep.com.br/
                        $.getJSON("https://viacep.com.br/ws/"+ cep +"/json/?callback=?", function(dados) {

                            if (!("erro" in dados)) {
                                //Atualiza os campos com os valores da consulta.
                                $("#endereco").val(dados.logradouro);
                                $("#bairro").val(dados.bairro);
                                $("#cidade").val(dados.localidade);
                                $("#estado").val(dados.uf);
                            } //end if.
                            else {
                                //CEP pesquisado não foi encontrado.
                                limpa_formulário_cep();
                                alert("CEP não encontrado.");
                            }
                        });
                    } //end if.
                    else {
                        //cep é inválido.
                        limpa_formulário_cep();
                        alert("Formato de CEP inválido.");
                    }
                } //end if.
                else {
                    //cep sem valor, limpa formulário.
                    limpa_formulário_cep();
                }
            });
        });

    </script>
    </head>
            
</head>
<body>
<div class="container">
	<div class="panel panel-default">
		<div class="panel-heading">
			<strong>Cadastro de Clientes</strong>
		</div>
		<div class="panel-body">
			<form class="form-horizontal" th:object="${cliente}" th:action="@{/save}" method="POST" style="margin: 10px">
				<div class="form-row">
 					<fieldset>
						<div class="form-group row">
							<div class="alert alert-danger" th:if="${#fields.hasAnyErrors()}">
								<div th:each="detailedError : ${#fields.detailedErrors()}">
									<span th:text="${detailedError.message}"></span>
								</div>
							</div>
						</div> 					
						<div class="form-group row">
						    <div class="col-md-1">
						        <input type="text" class="form-control input-sm" id="id" th:field="*{id}" readOnly="readonly"/>
						    </div>
						 </div>
						<div class="form-group row">                                                          
							<div class="col-md-4" th:classappend="${#fields.hasErrors('nome')}? 'has-error'">
							    <label>Nome</label>
							    <input type="text" class="form-control input-sm" th:field="*{nome}" autofocus="autofocus" placeholder="Informe seu nome" maxlength="50"/>
							</div>
						</div>
						<div class="form-group row">
							<div class="col-md-2" th:classappend="${#fields.hasErrors('cpf')}? 'has-error'">
								<label>CPF</label> 
								<input type="text" class="form-control input-sm" th:field="*{cpf}" maxlength="150" placeholder="Informe o cpf"/>
							</div>
						</div>
						<div class="form-group row">
							<div class="col-md-2" th:classappend="${#fields.hasErrors('telefone')}? 'has-error'">
								<label>Telefone</label> 
								<input type="text" class="form-control input-sm" th:field="*{telefone}" maxlength="150" placeholder="Inserir o telefone"/>
							</div>
						</div>					
						<div class="form-group row">
							<div class="col-md-2" th:classappend="${#fields.hasErrors('cep')}? 'has-error'">
								<label>CEP</label> 
								<input type="text" class="form-control input-sm" th:field="*{cep}" maxlength="150" placeholder="cep"/>
							</div>
						</div>
						<div class="form-group row">
							<div class="col-md-2" th:classappend="${#fields.hasErrors('endereco')}? 'has-error'">
								<label>Endereço</label> 
								<input type="text" class="form-control input-sm" th:field="*{endereco}" maxlength="150" placeholder="Informe o telefone"/>
							</div>
						</div>
						<div class="form-group row">
							<div class="col-md-2" th:classappend="${#fields.hasErrors('numero')}? 'has-error'">
								<label>Número</label> 
								<input type="text" class="form-control input-sm" th:field="*{numero}" maxlength="150" placeholder="Informe o telefone"/>
							</div>
						</div>
						<div class="form-group row">
							<div class="col-md-2" th:classappend="${#fields.hasErrors('bairro')}? 'has-error'">
								<label>Bairro</label> 
								<input type="text" class="form-control input-sm" th:field="*{bairro}" maxlength="150" placeholder="Informe o bairro"/>
							</div>
						</div>
						<div class="form-group row">
							<div class="col-md-2" th:classappend="${#fields.hasErrors('cidade')}? 'has-error'">
								<label>Cidade</label> 
								<input type="text" class="form-control input-sm" th:field="*{cidade}" maxlength="150" placeholder="Informe o telefone"/>
							</div>
						</div>
						<div class="form-group row">
							<div class="col-md-2" th:classappend="${#fields.hasErrors('estado')}? 'has-error'">
								<label>UF</label> 
								<input type="text" class="form-control input-sm" th:field="*{estado}" maxlength="150" placeholder="Informe o telefone"/>
							</div>
						</div>
						<div class="form-group row">
							<div class="col-md-2" th:classappend="${#fields.hasErrors('pais')}? 'has-error'">
								<label>País</label> 
								<input type="text" class="form-control input-sm" th:field="*{pais}" maxlength="150" placeholder="Informe o telefone"/>
							</div>
						</div>				
					</fieldset>
				</div>
				<div class="form-row">
					<button type="submit" class="btn btn-sm btn-primary">Salvar</button>
					<a th:href="@{/}" class="btn btn-sm btn-default">Cancelar</a>
				</div>
			</form>
		</div>
	</div>
</div>
</body>
</html>